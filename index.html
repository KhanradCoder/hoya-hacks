<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
<canvas id="chart"></canvas>
<script>
d3.csv('https://raw.githubusercontent.com/KhanradCoder/hoya-hacks/main/firstyearhousing_monthy.csv').then(function(data) {
  var house_name = 'TUTTLE-DUNNINGTON';
  var houseData = data.filter(function(d) { return d.House === house_name; });

  const months = ['Jan 2023', 'Feb 2023', 'Mar 2023', 'Apr 2023', 'May 2023', 'Jun 2023', 'Jul 2023', 'Aug 2023', 'Sep 2023', 'Oct 2023', 'Nov 2023', 'Dec 2023'];
  var electricity = months.map(function(month) { return parseFloat(houseData[0][month].replace(/,/g, '')); });
  var hotWater = months.map(function(month) { return parseFloat(houseData[1][month].replace(/,/g, '')); });
  var water = months.map(function(month) { return parseFloat(houseData[2][month].replace(/,/g, '')); });
  
  var z_params = ['Mean', 'Standard Deviation']
  var z_electric = z_params.map(function(param) { return parseFloat(houseData[0][param].replace(/,/g, '')); });
  var z_hotWater = z_params.map(function(param) { return parseFloat(houseData[1][param].replace(/,/g, '')); });
  var z_water = z_params.map(function(param) { return parseFloat(houseData[2][param].replace(/,/g, '')); });

  var score_electric = electricity.map(function(value) {return ((value - z_electric[0]) / z_electric[1]) + 4;});
  var score_hotWater = hotWater.map(function(value) {return ((value - z_hotWater[0]) / z_hotWater[1]) + 4;});
  var score_water = water.map(function(value) {return ((value - z_water[0]) / z_water[1]) + 4;});

  var ctx = document.getElementById('chart').getContext('2d');
  var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: months,
      datasets: [{
        label: 'Electricity',
        data: score_electric,
        backgroundColor: 'rgb(190, 156, 146, 0.2)',
        borderColor: 'rgb(190, 156, 146, 1)',
        borderWidth: 1
      },
      {
        label: 'Hot Water',
        data: score_hotWater,
        backgroundColor: 'rgb(178, 146, 190, 0.2)',
        borderColor: 'rgb(178, 146, 190, 1)',
        borderWidth: 1
      },
      {
        label: 'Water',
        data: score_water,
        backgroundColor: 'rgb(146, 180, 190, 0.2)',
        borderColor: 'rgb(146, 180, 190, 1)',
        borderWidth: 1
      }]
    },
    options: {
      title: {
        display: true,
        text: house_name+' HOUSE ENVIRONMENTAL IMPACT',
      },
      scales: {
        xAxes: [{
          stacked: true
        }],
        yAxes: [{
          stacked: true,
          ticks: {
            min: 0,
            suggestedMax: 18
          }
        }]
      }
    }
  });
});
</script>
<script src="leaderboard.js"></script>